# CVE-2024-21172: CREDENTIAL EXFILTRATION VIA SMB
[![](https://img.shields.io/badge/Attack%20Vector-Remote-red?style=flat-square)]() [![](https://img.shields.io/badge/Privileges%20Required-No-red?style=flat-square)]() [![](https://img.shields.io/badge/User%20Interaction-No-red?style=flat-square)]()

__Vendor:__ Oracle Hospitality OPERA 5<br>
__Vendor URL:__ https://www.oracle.com/es/hospitality/products/opera-property-services/<br>
__Versions affected:__ 5.6.19.19, 5.6.25.8, 5.6.26.4<br>
__Discovered by:__ Marcos DÃ­az<br>
__Public fix:__ Yes<br>
__Proof of Concept:__ No <br>


## Summary

Oracle Hospitality OPERA 5 versions 5.6.19.19, 5.6.25.8, 5.6.26.4, are affected by a coerce auth NTLM vulnerability via an HTTP request.

## Details

The servlet `com.micros.opera.servlet.FileInfo` (**operainternalservlets.war**) can be used to coerce a NTLM authentication against an arbitrary SMB server using UNC paths.

## Impact

Successful attacks of this vulnerability can result in takeover of Oracle Hospitality OPERA 5.

## Recommendation

Update Oracle Hospitality OPERA 5.

## Timeline

* 04/02/2024 - Vulnerability report to vendor
* 15/10/2024 - Public Disclosure

------

[![](https://img.shields.io/badge/www-blackarrow.net-E5A505?style=flat-square)](https://www.blackarrow.net) [![](https://img.shields.io/badge/twitter-@BlackArrowSec-00aced?style=flat-square&logo=twitter&logoColor=white)](https://twitter.com/BlackArrowSec) [![](https://img.shields.io/badge/linkedin-@BlackArrowSec-0084b4?style=flat-square&logo=linkedin&logoColor=white)](https://www.linkedin.com/company/blackarrowsec/)