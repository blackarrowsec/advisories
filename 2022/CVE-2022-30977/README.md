# CVE-2022-30977: Remote Code Execution in ProactivaNET <= 10.14
[![](https://img.shields.io/badge/Attack%20Vector-Remote-red?style=flat-square)]() [![](https://img.shields.io/badge/Privileges%20Required-Low-yellow?style=flat-square)]() [![](https://img.shields.io/badge/User%20Interaction-No-red?style=flat-square)]()

__Vendor:__ ProactivaNET<br>
__Vendor URL:__ https://www.proactivanet.com/discovery-gestion-de-activos<br>
__Versions affected:__ ProactivaNET <= 10.14<br>
__Discovered by:__ Pablo Martinez ([@xassiz](https://twitter.com/xassiz))<br>
__Public fix:__ Yes<br>
__Proof of Concept:__ No <br>


## Summary

ProactivaNET through 10.14 allows the unrestricted uploading of a Web.config file, resulting in OS command execution.

## Details

The file upload functionality in the `/proactivanet/paw3/pages/insertImg/default.paw` endpoint does not properly validate the file extensions (other uploaders may be affected). It is possible to upload any file using capital letters for its extension, bypassing the blacklist.

Even though script execution is disabled in the upload directory, a remote authenticated user can upload a Web.config file in order to execute arbitrary commands on the server.

## Impact

Command execution can be achieved by uploading a Web.config file.

## Recommendation

Update to the latest available version of the software.

## Timeline
* 20/04/2022 - Reported vulnerability to vendor
* 05/05/2022 - Meeting with the ProactivaNET team to explain the details
* 16/08/2022 - Public Disclosure

------

[![](https://img.shields.io/badge/www-blackarrow.net-E5A505?style=flat-square)](https://www.blackarrow.net) [![](https://img.shields.io/badge/twitter-@BlackArrowSec-00aced?style=flat-square&logo=twitter&logoColor=white)](https://twitter.com/BlackArrowSec) [![](https://img.shields.io/badge/linkedin-@BlackArrowSec-0084b4?style=flat-square&logo=linkedin&logoColor=white)](https://www.linkedin.com/company/blackarrowsec/)

